# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL 14.17

1. –°–∫–∞—á–∞–π—Ç–µ PostgreSQL 14.17 —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞:
   [PostgreSQL 14.17](https://www.enterprisedb.com/downloads/postgres-postgresql-downloads)

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL, —Å–ª–µ–¥—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞.

## 2. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞):

- "dbname": "postgres",
- "user": "postgres",
- "password": "qwerty123!",
- "host": "localhost",
- "port": "5432"

## 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–∞–º–ø–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `dump.sql` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü.

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–∞–º–ø —á–µ—Ä–µ–∑:

- DBeaver (–∏–º–ø–æ—Ä—Ç SQL-—Å–∫—Ä–∏–ø—Ç–∞)

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

- objects - –æ–±—ä–µ–∫—Ç—ã

- object_estimates - –æ–±—ä–µ–∫—Ç–Ω—ã–µ —Å–º–µ—Ç—ã

- local_estimates - –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–º–µ—Ç—ã

- sections - —Ä–∞–∑–¥–µ–ª—ã

- work - —Ä–∞–±–æ—Ç—ã

- materials - –º–∞—Ç–µ—Ä–∏–∞–ª—ã

–°—Ö–µ–º–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ SQL-–¥–∞–º–ø–µ.

## 5. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–î–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [DBeaver](https://dbeaver.io/).

## 6. –°–∫—Ä–∏–ø—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —ç—Ç—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

- files_parsing.py

- parsing_object_smeta.py

- db_q_2.py

# –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ (—Å–∫—Ä–∏–ø—Ç—ã)

# File Type Identifier (`type_opr.py`)

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Ñ–∞–π–ª–∞ –ø–æ –µ–≥–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ (–ø–µ—Ä–≤—ã–º –±–∞–π—Ç–∞–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ).

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **GGE** (—Ñ–∞–π–ª—ã —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π `GGE ` –∏–ª–∏ XML-—Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.gge`)
- **XLSX** (—Ñ–∞–π–ª—ã Microsoft Excel, —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ `PK\x03\x04`)
- **XLS** (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç Excel, —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ `\xD0\xCF\x11\xE0\xA1\xB1\x1A\xE1`)
- **XML** (—Ñ–∞–π–ª—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å `<?xml `)
- –î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"

# –ü–∞—Ä—Å–µ—Ä –æ–±—ä–µ–∫—Ç–Ω—ã—Ö —Å–º–µ—Ç `parsing_object_smeta.py`

![Python](https://img.shields.io/badge/Python-3.6%2B-blue)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-13%2B-blue)
![Pandas](https://img.shields.io/badge/Pandas-1.0%2B-orange)

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel-—Ñ–∞–π–ª–æ–≤ —Å –æ–±—ä–µ–∫—Ç–Ω—ã–º–∏ —Å–º–µ—Ç–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL.

## üõ† –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel-—Ñ–∞–π–ª–æ–≤ —Å–º–µ—Ç:
  - –ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
  - –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–Ω–æ–π —Å–º–µ—Ç—ã
  - –°–º–µ—Ç–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç)
  - –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–º–µ—Ç
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –ë–î PostgreSQL

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
1. –§–æ—Ä–º–∞—Ç Excel-—Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

2. –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑:

- "–Ω–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ"

- "(–æ–±—ä–µ–∫—Ç–Ω–∞—è —Å–º–µ—Ç–∞)"

- "–°–º–µ—Ç–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å"

- "–õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–º–µ—Ç—ã (—Ä–∞—Å—á–µ—Ç—ã)"

3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã .xlsx (Excel 2007+)

# XML Parser –¥–ª—è —Å–º–µ—Ç –≤ PostgreSQL `parsing_xml_db.py`

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML-—Ñ–∞–π–ª–æ–≤ —Å–º–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- –ü–∞—Ä—Å–∏–Ω–≥ XML-—Ñ–∞–π–ª–æ–≤ —Å–º–µ—Ç
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL:
  - –†–∞–∑–¥–µ–ª—ã —Å–º–µ—Ç—ã
  - –†–∞–±–æ—Ç—ã (–§–ï–†/–¢–ï–†)
    - —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã
    - –µ–¥-–∏–∑–º
  - –ú–∞—Ç–µ—Ä–∏–∞–ª—ã (–§–°–°–¶/–¢–°–°–¶)
      - —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã
      - –µ–¥-–∏–∑–º
  - –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–º–µ—Ç—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

- –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ XML

- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

- –û—à–∏–±–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö —Å –æ—Ç–∫–∞—Ç–æ–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–º–µ—Ç `files_parsing.py`

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±—ä–µ–∫—Ç–Ω—ã—Ö –∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–º–µ—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö (XLSX, XML –∏ –¥—Ä.) —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∏–ª–∏ –≤—ã–±–æ—Ä –≤ –¥–∏–∞–ª–æ–≥–µ)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ (XLSX, XML –∏ –¥—Ä.)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ä–µ–∫—Ç–Ω—ã—Ö —Å–º–µ—Ç (XLSX)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–º–µ—Ç (XML)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–º–µ—Ç

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í–∫–ª–∞–¥–∫–∞ "–û–±—ä–µ–∫—Ç–Ω—ã–µ —Å–º–µ—Ç—ã":

–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –æ–±—ä–µ–∫—Ç–Ω–æ–π —Å–º–µ—Ç—ã (XLSX)

–ù–∞–∂–º–∏—Ç–µ "–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–±—ä–µ–∫—Ç–Ω—É—é —Å–º–µ—Ç—É"

–í–∫–ª–∞–¥–∫–∞ "–õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–º–µ—Ç—ã":

–í—ã–±–µ—Ä–∏—Ç–µ —Å–º–µ—Ç—É –∏–∑ —Å–ø–∏—Å–∫–∞

–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ XML —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–º–µ—Ç—ã

–ù–∞–∂–º–∏—Ç–µ "–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é —Å–º–µ—Ç—É"

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- files_parsing.py - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å GUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

- parsing_object_smeta.py - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ä–µ–∫—Ç–Ω—ã—Ö —Å–º–µ—Ç (XLSX)

- parsing_xml_db.py - –æ–±—Ä–∞–±–æ—Ç–∫–∞ XML —Å–º–µ—Ç

- type_opr.py - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞

# –ó–∞–ø—Ä–æ—Å—ã

# SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–º–µ—Ç

–§–∞–π–ª `request_1.sql` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–º–µ—Ç–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤.

## –ó–∞–ø—Ä–æ—Å 1.1: –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç

```sql
SELECT 
    w.name_work AS work_name,
    COUNT(*) AS total_occurrences,
    COUNT(DISTINCT le.id) AS distinct_estimates_count
FROM 
    work w
JOIN 
    sections s ON w.local_section_id = s.id
JOIN 
    local_estimates le ON s.estimate_id = le.id
GROUP BY 
    w.name_work
ORDER BY 
    total_occurrences DESC;
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∏–¥–æ–≤ —Ä–∞–±–æ—Ç –≤ —Å–º–µ—Ç–∞—Ö.

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:

- work_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

- total_occurrences - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Ä–∞–±–æ—Ç—ã

- distinct_estimates_count - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–º–µ—Ç, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —ç—Ç–∞ —Ä–∞–±–æ—Ç–∞

–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π.

## –ó–∞–ø—Ä–æ—Å 1.2: –ê–Ω–∞–ª–∏–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

```sql

SELECT 
    m.name_material AS material_name,
    COUNT(*) AS total_occurrences,
    COUNT(DISTINCT le.id) AS distinct_estimates_count
FROM 
    materials m
JOIN 
    work w ON m.work_id = w.id
JOIN 
    sections s ON w.local_section_id = s.id
JOIN 
    local_estimates le ON s.estimate_id = le.id
GROUP BY 
    m.name_material
ORDER BY 
    total_occurrences DESC;
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ —Å–º–µ—Ç–∞—Ö.

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:

- material_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

- total_occurrences - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–∞

- distinct_estimates_count - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–º–µ—Ç, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —ç—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª

–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π.

# –ó–∞–ø—Ä–æ—Å 2. –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ê–† –∏ –ö–† –≤ —Å–º–µ—Ç–∞—Ö `db_q_2.py`

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `db_q_2.py` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ PostgreSQL –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–≥–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏:

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π (–ê–†)
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π (–ö–†)
–∫ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

- –°–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

- –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–æ–∂–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π:

- –°—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –ê–† –ø–æ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É

- –°—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –ö–† –ø–æ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É

- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

- –í—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ê–† –∏ –ö–† –∫ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏

- –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞

–ó–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

- CTE (Common Table Expressions) –¥–ª—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤

- ILIKE –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —à–∞–±–ª–æ–Ω–∞–º –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Å–º–µ—Ç

- NULLIF –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å

- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–º–µ—Ç

1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ê–†):

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –ö—Ä–æ–≤–ª—è –∏ –∫–ª–∞–¥–∫–∞

- –í–∏—Ç—Ä–∞–∂–∏

- –û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

2. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ö–†):

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∏ –æ–±—ä–µ–º–Ω–æ-–ø–ª–∞–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–µ

- –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ,–º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–µ

- –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

# –î–û–ü –ü–∞–ø–∫–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ xml)

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML-—Ñ–∞–π–ª–æ–≤ —Å–º–µ—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞–ø–∫–∏

–í –ø–∞–ø–∫–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª `parsing_xml.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML-—Å–º–µ—Ç.

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ parsing_xml.py

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ XML-—Ñ–∞–π–ª–∞ —Å–º–µ—Ç—ã:
   - –ù–∞–∑–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
   - –†–∞–±–æ—Ç—ã (—Å –∫–æ–¥–æ–º –§–ï–†/–¢–ï–†) —Å —Ü–µ–Ω–∞–º–∏
   - –ú–∞—Ç–µ—Ä–∏–∞–ª—ã (—Å –∫–æ–¥–æ–º –§–°–°–¶/–¢–°–°–¶) —Å —Ü–µ–Ω–∞–º–∏
   - –í—Å–µ —Ü–µ–Ω—ã
   - –û–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–º–µ—Ç—ã

2. –ü—Ä–æ–≤–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∑–∏—Ü–∏–π
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–∞ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
   - –ù–∞–ª–∏—á–∏—è –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- `extract_sections_works_units_prices_and_materials(xml_file: str) -> Dict` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä XML
- `calculate_total_cost(sections: Dict) -> float` - –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–º–µ—Ç—ã
- `run_tests(sections: Dict) -> None` - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
